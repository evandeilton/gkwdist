<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generalized Kumaraswamy Distribution Family — gkwdist-package • gkwdist</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Kumaraswamy Distribution Family — gkwdist-package"><meta name="description" content="The gkwdist package provides a comprehensive, high-performance
implementation of the five-parameter Generalized Kumaraswamy (GKw)
distribution and its seven nested sub-families for modeling bounded
continuous data on the unit interval \((0,1)\). All distribution and
likelihood functions are implemented in C++ via
RcppArmadillo for maximum computational efficiency."><meta property="og:description" content="The gkwdist package provides a comprehensive, high-performance
implementation of the five-parameter Generalized Kumaraswamy (GKw)
distribution and its seven nested sub-families for modeling bounded
continuous data on the unit interval \((0,1)\). All distribution and
likelihood functions are implemented in C++ via
RcppArmadillo for maximum computational efficiency."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwdist</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/gkwdist" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generalized Kumaraswamy Distribution Family</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/gkwdist/blob/main/R/gkwdist-package.R" class="external-link"><code>R/gkwdist-package.R</code></a></small>
      <div class="d-none name"><code>gkwdist-package.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <span class="pkg">gkwdist</span> package provides a comprehensive, high-performance
implementation of the five-parameter Generalized Kumaraswamy (GKw)
distribution and its seven nested sub-families for modeling bounded
continuous data on the unit interval \((0,1)\). All distribution and
likelihood functions are implemented in <strong>C++</strong> via
<span class="pkg">RcppArmadillo</span> for maximum computational efficiency.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a></h3>
<p>The Generalized Kumaraswamy distribution, proposed by Carrasco, Ferrari and
Cordeiro (2010), extends the Kumaraswamy distribution (Jones, 2009) by
incorporating three additional shape parameters. This generalization provides
remarkable flexibility in accommodating various density shapes including
unimodality, bimodality, asymmetry, J-shapes, inverted J-shapes, U-shapes,
bathtub shapes, and heavy or light tails.</p>
</div>

<div class="section">
<h3 id="mathematical-specification">Mathematical Specification<a class="anchor" aria-label="anchor" href="#mathematical-specification"></a></h3>
<p>The probability density function (PDF) of the GKw distribution with
parameters \(\theta = (\alpha, \beta, \gamma, \delta, \lambda)\)
(all positive) is:
$$f(x; \theta) = \frac{\lambda\alpha\beta x^{\alpha-1}}{B(\gamma, \delta + 1)}
(1 - x^\alpha)^{\beta-1} [1 - (1 - x^\alpha)^\beta]^{\gamma\lambda-1}
\{1 - [1 - (1 - x^\alpha)^\beta]^\lambda\}^\delta$$
for \(0 &lt; x &lt; 1\), where \(B(a,b) = \Gamma(a)\Gamma(b)/\Gamma(a+b)\)
is the beta function.</p>
<p>The cumulative distribution function (CDF) is:
$$F(x; \theta) = I_{[1-(1-x^\alpha)^\beta]^\lambda}(\gamma, \delta + 1)$$
where \(I_y(a,b)\) denotes the regularized incomplete beta function ratio.</p>
</div>

<div class="section">
<h3 id="distribution-family-hierarchy">Distribution Family Hierarchy<a class="anchor" aria-label="anchor" href="#distribution-family-hierarchy"></a></h3>
<p>The GKw distribution nests seven important sub-models:</p><dl><dt><strong>Beta-Kumaraswamy (BKw)</strong></dt>
<dd><p>4 parameters:
\((\alpha, \beta, \gamma, \delta)\). Set \(\lambda = 1\) in GKw.</p></dd>

<dt><strong>Kumaraswamy-Kumaraswamy (KKw)</strong></dt>
<dd><p>4 parameters:
\((\alpha, \beta, \delta, \lambda)\). Set \(\gamma = 1\) in GKw.</p></dd>

<dt><strong>Exponentiated Kumaraswamy (EKw)</strong></dt>
<dd><p>3 parameters:
\((\alpha, \beta, \lambda)\). Set \(\gamma = 1, \delta = 0\) in GKw.
Has closed-form quantile function.</p></dd>

<dt><strong>McDonald (Mc)</strong></dt>
<dd><p>3 parameters:
\((\gamma, \delta, \lambda)\). Set \(\alpha = \beta = 1\) in GKw.
Also known as Beta-Power distribution.</p></dd>

<dt><strong>Kumaraswamy (Kw)</strong></dt>
<dd><p>2 parameters: \((\alpha, \beta)\).
Set \(\gamma = \delta = \lambda = 1\) in GKw. Has closed-form CDF
and quantile function.</p></dd>

<dt><strong>Beta</strong></dt>
<dd><p>2 parameters: \((\gamma, \delta)\).
Set \(\alpha = \beta = \lambda = 1\) in GKw. Classical beta
distribution with <code>shape1 = gamma</code>, <code>shape2 = delta + 1</code>.</p></dd>

<dt><strong>Uniform</strong></dt>
<dd><p>0 parameters. Set all shape parameters to 1.</p></dd>


</dl></div>

    </div>
    <div class="section level2">
    <h2 id="distribution-functions">Distribution Functions<a class="anchor" aria-label="anchor" href="#distribution-functions"></a></h2>


<p>The package provides the standard R distribution function API for all
seven distributions. Each distribution has four core functions with
prefix <code>d</code>, <code>p</code>, <code>q</code>, <code>r</code>:</p>
<p><strong>Generalized Kumaraswamy (GKw):</strong></p><ul><li><p><code><a href="dgkw.html">dgkw</a></code>: Density function</p></li>
<li><p><code><a href="pgkw.html">pgkw</a></code>: Distribution function (CDF)</p></li>
<li><p><code><a href="qgkw.html">qgkw</a></code>: Quantile function (inverse CDF)</p></li>
<li><p><code><a href="rgkw.html">rgkw</a></code>: Random generation</p></li>
</ul><p><strong>Beta-Kumaraswamy (BKw):</strong>
<code><a href="dbkw.html">dbkw</a></code>, <code><a href="pbkw.html">pbkw</a></code>, <code><a href="qbkw.html">qbkw</a></code>, <code><a href="rbkw.html">rbkw</a></code></p>
<p><strong>Kumaraswamy-Kumaraswamy (KKw):</strong>
<code><a href="dkkw.html">dkkw</a></code>, <code><a href="pkkw.html">pkkw</a></code>, <code><a href="qkkw.html">qkkw</a></code>, <code><a href="rkkw.html">rkkw</a></code></p>
<p><strong>Exponentiated Kumaraswamy (EKw):</strong>
<code><a href="dekw.html">dekw</a></code>, <code><a href="pekw.html">pekw</a></code>, <code><a href="qekw.html">qekw</a></code>, <code><a href="rekw.html">rekw</a></code></p>
<p><strong>McDonald (Mc):</strong>
<code><a href="dmc.html">dmc</a></code>, <code><a href="pmc.html">pmc</a></code>, <code><a href="qmc.html">qmc</a></code>, <code><a href="rmc.html">rmc</a></code></p>
<p><strong>Kumaraswamy (Kw):</strong>
<code><a href="dkw.html">dkw</a></code>, <code><a href="pkw.html">pkw</a></code>, <code><a href="qkw.html">qkw</a></code>, <code><a href="rkw.html">rkw</a></code></p>
<p><strong>Beta:</strong>
<code><a href="dbeta_.html">dbeta_</a></code>, <code><a href="pbeta_.html">pbeta_</a></code>, <code><a href="qbeta_.html">qbeta_</a></code>, <code><a href="rbeta_.html">rbeta_</a></code></p>
<p>All distribution functions are implemented in C++ for optimal performance.</p>
    </div>
    <div class="section level2">
    <h2 id="likelihood-functions">Likelihood Functions<a class="anchor" aria-label="anchor" href="#likelihood-functions"></a></h2>


<p>High-performance analytical log-likelihood, gradient, and Hessian functions
are provided for maximum likelihood estimation. These functions return
<strong>negative</strong> values to facilitate direct use with optimization routines
like <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>, which perform minimization by default.</p>
<p>Function signature: <code>function(par, data)</code> where <code>par</code> is a numeric
vector of parameters and <code>data</code> is the observed sample.</p>
<dl><dt><code>ll*</code></dt>
<dd><p>Negative log-likelihood:
\(-\ell(\theta) = -\sum_{i=1}^n \log f(x_i; \theta)\)</p></dd>

<dt><code>gr*</code></dt>
<dd><p>Negative gradient (negative score vector):
\(-\nabla_\theta \ell(\theta)\)</p></dd>

<dt><code>hs*</code></dt>
<dd><p>Negative Hessian matrix:
\(-\nabla^2_\theta \ell(\theta)\)</p></dd>


</dl><p>Available for all distributions:</p><ul><li><p><strong>GKw:</strong> <code><a href="llgkw.html">llgkw</a></code>, <code><a href="grgkw.html">grgkw</a></code>, <code><a href="hsgkw.html">hsgkw</a></code></p></li>
<li><p><strong>BKw:</strong> <code><a href="llbkw.html">llbkw</a></code>, <code><a href="grbkw.html">grbkw</a></code>, <code><a href="hsbkw.html">hsbkw</a></code></p></li>
<li><p><strong>KKw:</strong> <code><a href="llkkw.html">llkkw</a></code>, <code><a href="grkkw.html">grkkw</a></code>, <code><a href="hskkw.html">hskkw</a></code></p></li>
<li><p><strong>EKw:</strong> <code><a href="llekw.html">llekw</a></code>, <code><a href="grekw.html">grekw</a></code>, <code><a href="hsekw.html">hsekw</a></code></p></li>
<li><p><strong>Mc:</strong> <code><a href="llmc.html">llmc</a></code>, <code><a href="grmc.html">grmc</a></code>, <code><a href="hsmc.html">hsmc</a></code></p></li>
<li><p><strong>Kw:</strong> <code><a href="llkw.html">llkw</a></code>, <code><a href="grkw.html">grkw</a></code>, <code><a href="hskw.html">hskw</a></code></p></li>
<li><p><strong>Beta:</strong> <code><a href="llbeta.html">llbeta</a></code>, <code><a href="grbeta.html">grbeta</a></code>, <code><a href="hsbeta.html">hsbeta</a></code></p></li>
</ul><p>These analytical derivatives are exact (up to floating-point precision) and
provide substantial performance gains over numerical approximations.</p>
    </div>
    <div class="section level2">
    <h2 id="utility-functions">Utility Functions<a class="anchor" aria-label="anchor" href="#utility-functions"></a></h2>


<ul><li><p><code><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></code>: Compute starting values for
optimization using method of moments or quantile matching</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="applications">Applications<a class="anchor" aria-label="anchor" href="#applications"></a></h2>


<p>The GKw distribution family is particularly suitable for modeling:</p><ul><li><p><strong>Proportions and rates</strong>: Bounded continuous data in \((0,1)\)</p></li>
<li><p><strong>Percentages</strong>: Economic indices, market shares, conversion rates</p></li>
<li><p><strong>Fractions</strong>: Parts of a whole, concentration measures</p></li>
<li><p><strong>Scores and indices</strong>: Normalized measurements, standardized tests</p></li>
<li><p><strong>Reliability data</strong>: Component lifetimes on bounded domains</p></li>
<li><p><strong>Hydrological phenomena</strong>: Reservoir levels, soil moisture content</p></li>
<li><p><strong>Financial ratios</strong>: Debt-to-equity, current ratio, profit margins</p></li>
<li><p><strong>Quality metrics</strong>: Defect rates, efficiency scores, purity levels</p></li>
<li><p><strong>Biostatistics</strong>: Survival probabilities, dose-response curves</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="advantages-over-standard-distributions">Advantages Over Standard Distributions<a class="anchor" aria-label="anchor" href="#advantages-over-standard-distributions"></a></h2>


<p>Compared to the classical Beta distribution, the GKw family offers:</p><ul><li><p>Greater flexibility in density shapes (bimodal, U-shaped, bathtub)</p></li>
<li><p>Better accommodation of asymmetry and tail behavior</p></li>
<li><p>Closed-form CDF and quantile for some sub-models (Kw, EKw, KKw)</p></li>
<li><p>Computational efficiency via C++ implementation</p></li>
<li><p>Easy parameter interpretation through nested structure</p></li>
<li><p>Superior performance for extreme parameter values</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a></h2>


<p>All functions are implemented in C++ using <span class="pkg">RcppArmadillo</span>, providing:</p><ul><li><p>10-100× speedup over pure R implementations</p></li>
<li><p>Linear scaling with sample size</p></li>
<li><p>Optimized memory allocation</p></li>
<li><p>Numerical stability for extreme parameter values</p></li>
<li><p>Efficient vectorized operations</p></li>
</ul><p>Typical benchmarks on modern hardware:</p><ul><li><p>Density evaluation: \(&gt;10^7\) evaluations per second</p></li>
<li><p>Log-likelihood: \(n = 10^6\) observations in \(&lt;100\)ms</p></li>
<li><p>Gradient computation: \(&lt;5\)× slower than log-likelihood</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="model-selection-workflow">Model Selection Workflow<a class="anchor" aria-label="anchor" href="#model-selection-workflow"></a></h2>


<p>Recommended strategy for choosing among distributions:</p><ol><li><p><strong>Exploratory Analysis</strong>: Examine histograms, kernel density
estimates, and summary statistics of your data.</p></li>
<li><p><strong>Start Simple</strong>: Fit Beta and Kumaraswamy distributions
(2 parameters). Use <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> with <code>method = "BFGS"</code>
and analytical gradients.</p></li>
<li><p><strong>Diagnostic Checking</strong>: Assess fit quality using Q-Q plots,
probability plots, and goodness-of-fit tests (e.g., Kolmogorov-Smirnov).</p></li>
<li><p><strong>Progressive Complexity</strong>: If simple models inadequate, try
3-parameter models (EKw or Mc), then 4-parameter models (BKw or KKw).</p></li>
<li><p><strong>Information Criteria</strong>: Use AIC, BIC, or AICc to balance
goodness-of-fit and model parsimony. Lower values indicate better models.</p></li>
<li><p><strong>Nested Testing</strong>: Perform likelihood ratio tests when
comparing nested models (e.g., Kw vs. EKw).</p></li>
<li><p><strong>Cross-Validation</strong>: Validate final model on held-out data
or via bootstrap procedures.</p></li>
<li><p><strong>Residual Analysis</strong>: Examine probability integral transform
residuals for uniformity and independence.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="statistical-inference">Statistical Inference<a class="anchor" aria-label="anchor" href="#statistical-inference"></a></h2>


<p>Maximum likelihood estimation is performed using numerical optimization:</p><ol><li><p>Obtain starting values via <code><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></code> or
manual specification based on sample moments</p></li>
<li><p>Minimize negative log-likelihood using <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>
with <code>method = "BFGS"</code> or <code>"L-BFGS-B"</code></p></li>
<li><p>Provide analytical gradient via <code>gr</code> argument for faster
convergence and improved accuracy</p></li>
<li><p>Set <code>hessian = TRUE</code> to obtain observed information matrix</p></li>
<li><p>Compute standard errors as <code>sqrt(diag(solve(hessian)))</code></p></li>
<li><p>Construct confidence intervals using normal approximation or
profile likelihood</p></li>
<li><p>Perform hypothesis tests using Wald, score, or likelihood ratio
statistics</p></li>
</ol><p>For large samples (\(n &gt; 10^4\)), consider using <code>method = "L-BFGS-B"</code>
with box constraints to prevent parameter estimates from drifting to
boundary values or becoming numerically unstable.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Carrasco, J. M. F., Ferrari, S. L. P., and Cordeiro, G. M. (2010).
A new generalized Kumaraswamy distribution.
<em>arXiv preprint arXiv:1004.0911</em>.
<a href="https://doi.org/10.48550/arXiv.1004.0911" class="external-link">doi:10.48550/arXiv.1004.0911</a></p>
<p>Jones, M. C. (2009).
Kumaraswamy's distribution: A beta-type distribution with some tractability
advantages.
<em>Statistical Methodology</em>, <strong>6</strong>(1), 70-81.
<a href="https://doi.org/10.1016/j.stamet.2008.04.001" class="external-link">doi:10.1016/j.stamet.2008.04.001</a></p>
<p>Kumaraswamy, P. (1980).
A generalized probability density function for double-bounded random processes.
<em>Journal of Hydrology</em>, <strong>46</strong>(1-2), 79-88.
<a href="https://doi.org/10.1016/0022-1694%2880%2990036-0" class="external-link">doi:10.1016/0022-1694(80)90036-0</a></p>
<p>Cordeiro, G. M., and de Castro, M. (2011).
A new family of generalized distributions.
<em>Journal of Statistical Computation and Simulation</em>, <strong>81</strong>(7), 883-898.
<a href="https://doi.org/10.1080/00949650903530745" class="external-link">doi:10.1080/00949650903530745</a></p>
<p>McDonald, J. B. (1984).
Some generalized functions for the size distribution of income.
<em>Econometrica</em>, <strong>52</strong>(3), 647-663.
<a href="https://doi.org/10.2307/1913469" class="external-link">doi:10.2307/1913469</a></p>
<p>Eddelbuettel, D., and Francois, R. (2011).
Rcpp: Seamless R and C++ Integration.
<em>Journal of Statistical Software</em>, <strong>40</strong>(8), 1-18.
<a href="https://doi.org/10.18637/jss.v040.i08" class="external-link">doi:10.18637/jss.v040.i08</a></p>
<p>Eddelbuettel, D., and Sanderson, C. (2014).
RcppArmadillo: Accelerating R with high-performance C++ linear algebra.
<em>Computational Statistics &amp; Data Analysis</em>, <strong>71</strong>, 1054-1063.
<a href="https://doi.org/10.1016/j.csda.2013.02.005" class="external-link">doi:10.1016/j.csda.2013.02.005</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">Beta</a></code> for the standard beta distribution,
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> for numerical optimization,
<code><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">dbeta</a></code> for beta distribution functions</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>J. E. Lopes <a href="mailto:evandeilton@gmail.com">evandeilton@gmail.com</a>
<a href="https://orcid.org/0009-0007-5887-4084" class="external-link">ORCID: 0009-0007-5887-4084</a></p>
<p>LEG - Laboratory of Statistics and Geoinformation</p>
<p>PPGMNE - Graduate Program in Numerical Methods in Engineering</p>
<p>Federal University of Paraná (UFPR), Brazil</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Example 1: Basic Distribution Functions</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwdist" class="external-link">gkwdist</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set parameters for GKw distribution</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">3.0</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">2.0</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create sequence of x values</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute density</span></span></span>
<span class="r-in"><span><span class="va">dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="dgkw.html">dgkw</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute CDF</span></span></span>
<span class="r-in"><span><span class="va">cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="pgkw.html">pgkw</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute specific quantiles</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.95</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">quants</span> <span class="op">&lt;-</span> <span class="fu"><a href="qgkw.html">qgkw</a></span><span class="op">(</span><span class="va">probs</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">quants</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1723 0.2886 0.3800 0.4743 0.6058</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualization</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># PDF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">dens</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"GKw Probability Density Function"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"f(x)"</span>, las <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># CDF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">cdf</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkred"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"GKw Cumulative Distribution Function"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"F(x)"</span>, las <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Histogram of random sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sample</span>,</span></span>
<span class="r-in"><span>  breaks <span class="op">=</span> <span class="fl">30</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"lightblue"</span>, border <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Random Sample from GKw"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, las <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">dens</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Q-Q plot</span></span></span>
<span class="r-in"><span><span class="va">theoretical</span> <span class="op">&lt;-</span> <span class="fu"><a href="qgkw.html">qgkw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/ppoints.html" class="external-link">ppoints</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">empirical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">theoretical</span>, <span class="va">empirical</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/rgb.html" class="external-link">rgb</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Q-Q Plot"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Theoretical Quantiles"</span>, ylab <span class="op">=</span> <span class="st">"Sample Quantiles"</span>, las <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwdist-package-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Example 2: Comparing Distribution Families</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create comparison plot</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># GKw (5 parameters) - most flexible</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="dgkw.html">dgkw</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1.5</span>, <span class="fl">2</span>, <span class="fl">1.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"black"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"GKw Distribution (5 params)"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># BKw (4 parameters)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="dbkw.html">dbkw</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkgreen"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"BKw Distribution (4 params)"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EKw (3 parameters)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="dekw.html">dekw</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkred"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"EKw Distribution (3 params)"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Kw (2 parameters) - base distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="dkw.html">dkw</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"darkblue"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Kw Distribution (2 params)"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, las <span class="op">=</span> <span class="fl">1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwdist-package-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Example 3: Maximum Likelihood Estimation</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate data from Kumaraswamy distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2024</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">2000</span></span></span>
<span class="r-in"><span><span class="va">true_alpha</span> <span class="op">&lt;-</span> <span class="fl">2.5</span></span></span>
<span class="r-in"><span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fl">3.5</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">true_alpha</span>, <span class="va">true_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obtain starting values</span></span></span>
<span class="r-in"><span><span class="va">start_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span>, n_starts <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Maximum likelihood estimation with analytical gradient</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  par <span class="op">=</span> <span class="va">start_vals</span>,</span></span>
<span class="r-in"><span>  fn <span class="op">=</span> <span class="va">llkw</span>, <span class="co"># Negative log-likelihood</span></span></span>
<span class="r-in"><span>  gr <span class="op">=</span> <span class="va">grkw</span>, <span class="co"># Analytical gradient</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span></span>
<span class="r-in"><span>  hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract results</span></span></span>
<span class="r-in"><span><span class="va">mle</span> <span class="op">&lt;-</span> <span class="va">fit</span><span class="op">$</span><span class="va">par</span></span></span>
<span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/solve.html" class="external-link">solve</a></span><span class="op">(</span><span class="va">fit</span><span class="op">$</span><span class="va">hessian</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Construct confidence intervals (95%)</span></span></span>
<span class="r-in"><span><span class="va">ci</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">true_alpha</span>, <span class="va">true_beta</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  MLE <span class="op">=</span> <span class="va">mle</span>,</span></span>
<span class="r-in"><span>  SE <span class="op">=</span> <span class="va">se</span>,</span></span>
<span class="r-in"><span>  Lower <span class="op">=</span> <span class="va">mle</span> <span class="op">-</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span>,</span></span>
<span class="r-in"><span>  Upper <span class="op">=</span> <span class="va">mle</span> <span class="op">+</span> <span class="fl">1.96</span> <span class="op">*</span> <span class="va">se</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ci</span>, digits <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Parameter True   MLE      SE Lower Upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha     alpha  2.5 2.533 0.05693 2.422 2.645</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta       beta  3.5 3.590 0.13664 3.322 3.858</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Goodness-of-fit diagnostic</span></span></span>
<span class="r-in"><span><span class="va">x_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fitted_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="dkw.html">dkw</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">mle</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">mle</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">true_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="dkw.html">dkw</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">true_alpha</span>, <span class="va">true_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">data</span>,</span></span>
<span class="r-in"><span>  breaks <span class="op">=</span> <span class="fl">40</span>, probability <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"lightgray"</span>, border <span class="op">=</span> <span class="st">"white"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Kumaraswamy Distribution Fit"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Data"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, las <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">fitted_dens</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x_grid</span>, <span class="va">true_dens</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>,</span></span>
<span class="r-in"><span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Data"</span>, <span class="st">"Fitted"</span>, <span class="st">"True"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  bty <span class="op">=</span> <span class="st">"n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span>col <span class="op">=</span> <span class="st">"gray80"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwdist-package-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Example 4: Model Selection Using Information Criteria</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate data from Exponentiated Kumaraswamy</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1500</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="rekw.html">rekw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, lambda <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define competing models</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ll <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="llbeta.html">llbeta</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="grbeta.html">grbeta</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"beta"</span>, n_starts <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  Kw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ll <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="llkw.html">llkw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="grkw.html">grkw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span>, n_starts <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  EKw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ll <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="llekw.html">llekw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="grekw.html">grekw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"ekw"</span>, n_starts <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  Mc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    ll <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="llmc.html">llmc</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    gr <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">par</span><span class="op">)</span> <span class="fu"><a href="grmc.html">grmc</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    start <span class="op">=</span> <span class="fu"><a href="gkwgetstartvalues.html">gkwgetstartvalues</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"mc"</span>, n_starts <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all models</span></span></span>
<span class="r-in"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">name</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">m</span> <span class="op">&lt;-</span> <span class="va">models</span><span class="op">[[</span><span class="va">name</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span>par <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">start</span>, fn <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">ll</span>, gr <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">gr</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">loglik</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="va">fit</span><span class="op">$</span><span class="va">value</span></span></span>
<span class="r-in"><span>  <span class="va">aic</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">loglik</span> <span class="op">+</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">m</span><span class="op">$</span><span class="va">k</span></span></span>
<span class="r-in"><span>  <span class="va">bic</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="va">loglik</span> <span class="op">+</span> <span class="va">m</span><span class="op">$</span><span class="va">k</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Model <span class="op">=</span> <span class="va">name</span>,</span></span>
<span class="r-in"><span>    k <span class="op">=</span> <span class="va">m</span><span class="op">$</span><span class="va">k</span>,</span></span>
<span class="r-in"><span>    LogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">loglik</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">aic</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">bic</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Combine and sort by AIC</span></span></span>
<span class="r-in"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">results</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="va">comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Model k LogLik     AIC     BIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    Kw 2 461.90 -919.80 -909.17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  Beta 2 461.54 -919.09 -908.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    Mc 3 462.32 -918.63 -902.69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   EKw 3 462.17 -918.35 -902.41</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nBest model by AIC:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">Model</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best model by AIC: Kw </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Best model by BIC:"</span>, <span class="va">comparison</span><span class="op">$</span><span class="va">Model</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best model by BIC: Kw </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Example 5: Performance Comparison</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"microbenchmark"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate large dataset</span></span></span>
<span class="r-in"><span>  <span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">10000</span></span></span>
<span class="r-in"><span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare different approaches</span></span></span>
<span class="r-in"><span>  <span class="va">benchmark</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="op">(</span></span></span>
<span class="r-in"><span>    Manual_R <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="dkw.html">dkw</a></span><span class="op">(</span><span class="va">data</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Cpp_LL <span class="op">=</span> <span class="fu"><a href="llkw.html">llkw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Cpp_Gradient <span class="op">=</span> <span class="fu"><a href="grkw.html">grkw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Cpp_Hessian <span class="op">=</span> <span class="fu"><a href="hskw.html">hskw</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    times <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">benchmark</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span><span class="co">## Example 6: Verifying Analytical Derivatives</span></span></span>
<span class="r-in"><span><span class="co">## ========================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate small sample</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="fl">100</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Analytical gradient</span></span></span>
<span class="r-in"><span><span class="va">grad_analytical</span> <span class="op">&lt;-</span> <span class="fu"><a href="grkw.html">grkw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Numerical gradient (for comparison)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"numDeriv"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">grad_numerical</span> <span class="op">&lt;-</span> <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/grad.html" class="external-link">grad</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    func <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="llkw.html">llkw</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">data</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">par</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare</span></span></span>
<span class="r-in"><span>  <span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Parameter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Analytical <span class="op">=</span> <span class="va">grad_analytical</span>,</span></span>
<span class="r-in"><span>    Numerical <span class="op">=</span> <span class="va">grad_numerical</span>,</span></span>
<span class="r-in"><span>    Difference <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">grad_analytical</span> <span class="op">-</span> <span class="va">grad_numerical</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span>, digits <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Maximum absolute difference</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"\nMax absolute difference:"</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">$</span><span class="va">Difference</span><span class="op">)</span>, scientific <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="st">"\n"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parameter   Analytical    Numerical      Difference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     alpha  2.945293344  2.945293345 2.175548630e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2      beta -2.845656040 -2.845656040 4.430185108e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max absolute difference: 4.430185e-10 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by J. E. Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

